---
- name: Install development related packages
  become: yes
  apt:
    name:
      - build-essential
      - clang
      - git
      - autoconf
      - bison
      - gcc
      - make
      - zlib1g-dev
      - libffi-dev
      - libreadline-dev
      - libgdm-dev
      - libssl-dev
      - universal-ctags
      - global
      - jq
      
- name: Stow Git config
  stow:
    name: git
    source: "{{ dotfile_path }}"
    overwrite_conflicts: yes

- name: Create source code directory
  file:
    path: "{{ ansible_env .HOME }}/src"
    state: directory

- name: Clone Ruby
  git:
    repo: "git@github.com:Shopify/ruby.git"
    dest: "{{ ansible_env .HOME }}/src/ruby"
    update: no

- name: Install rbenv
  git:
    repo: "https://github.com/rbenv/rbenv.git"
    dest: "{{ ansible_env .HOME }}/.rbenv"
    update: no

- name: Make rbenv plugins dir
  file:
    path: "{{ ansible_env .HOME }}/.rbenv/plugins"
    state: directory

- name: Install ruby-build
  git:
    repo: "https://github.com/rbenv/ruby-build.git"
    dest: "{{ ansible_env .HOME }}/.rbenv/plugins/ruby-build"
    update: no

